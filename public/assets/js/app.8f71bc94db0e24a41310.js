webpackJsonp([2,0],{0:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}function o(t){switch(t){case"/files":d["default"].registerModule("files",_["default"]);break;case"/clients":d["default"].registerModule("clients",b["default"]);break;default:return}}function i(t){switch(t){case"/files":d["default"].unregisterModule("files");break;case"/clients":d["default"].unregisterModule("clients");break;default:return}}n(140);var s=n(93),l=a(s),r=n(372),u=n(128),d=a(u),c=n(127),f=a(c),h=n(355),m=a(h),p=n(130),_=a(p),v=n(129),b=a(v);(0,r.sync)(d["default"],f["default"]),f["default"].beforeEach(function(t,e,n){o(t.path),i(e.path),n()}),new l["default"]({el:"#app",store:d["default"],router:f["default"],render:function(t){return t(m["default"])}})},127:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(93),i=a(o),s=n(371),l=a(s),r=n(356),u=a(r),d=n(357),c=a(d);i["default"].use(l["default"]),e["default"]=new l["default"]({routes:[{path:"/clients",component:u["default"]},{path:"/files",component:c["default"]}]})},128:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(41),i=a(o);n(352);var s=n(93),l=a(s),r=n(50),u=a(r),d=n(131),c=a(d);l["default"].use(u["default"]),e["default"]=new u["default"].Store({modules:{modal:c["default"]},getters:{files:function(t){return t.files.list},clients:function(t){return t.clients.list.map(function(t){return(0,i["default"])({},t,{status:"offline"===t.status?"离线":"在线"})})},online:function(t){return t.clients.list.reduce(function(t,e){return t+("online"===e.status?1:0)},0)}}})},129:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={state:{list:[]},mutations:{loadClients:function(t,e){t.list=e}},actions:{loadClients:function(t){var e=t.commit;fetch("/api/clients",{credentials:"same-origin"}).then(function(t){return t.json()}).then(function(t){1===t.code&&e("loadClients",t.data)})},removeClient:function(t,e){var n=t.dispatch;fetch("/api/client/"+e,{method:"DELETE",credentials:"same-origin"}).then(function(t){return t.json()}).then(function(t){alert(t.msg),n("loadClients")})["catch"](function(t){console.log(t)})}}}},130:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={state:{list:[]},mutations:{loadFiles:function(t,e){t.list=e}},actions:{loadFiles:function(t){var e=t.commit;fetch("/api/files",{credentials:"same-origin"}).then(function(t){return t.json()}).then(function(t){1===t.code&&e("loadFiles",t.data)})},removeFile:function(t,e){var n=t.dispatch;fetch("/api/file/"+e,{method:"DELETE",credentials:"same-origin"}).then(function(t){return t.json()}).then(function(t){alert(t.msg),n("loadFiles")})["catch"](function(t){console.log(t)})}}}},131:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(94),i=a(o),s=n(41),l=a(s),r={show:!1,type:"",title:"",form:"",data:{}};e["default"]={state:(0,l["default"])({},r),mutations:{showModal:function(t,e){(0,i["default"])(t,(0,l["default"])({},e))},closeModal:function(t){(0,i["default"])(t,(0,l["default"])({},r))},updateFormData:function(t,e){t.data=(0,l["default"])({},e)}},actions:{showModal:function(t,e){var n=t.commit;n("showModal",e)},closeModal:function(t){var e=t.commit;e("closeModal")},submitForm:function(t,e){var n=t.dispatch,a=e.url,o=e.headers,i=e.formData,s=e.action,l=e.modal;fetch(a,{headers:o,method:"POST",credentials:"same-origin",body:i}).then(function(t){return t.json()}).then(function(t){return alert(t.msg),$(l).modal("hide"),n(s)})["catch"](function(t){console.log(t)})}}}},132:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(360),i=a(o),s=n(358),l=a(s),r=n(359),u=a(r);e["default"]={name:"app",components:{Navbar:i["default"],Menus:l["default"],Modal:u["default"]}}},133:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(41),i=a(o),s=n(50);e["default"]={name:"clients",methods:(0,i["default"])({},(0,s.mapActions)(["loadClients","showModal","removeClient"]),{add:function(){this.showModal({show:!0,type:"add",title:"添加客户端",form:"client",data:{}})},edit:function(t){var e=t._id,n=t.key,a=t.token,o=t.description;this.showModal({show:!0,type:"edit",title:"编辑客户端",form:"client",data:{id:e,key:n,token:a,description:o}})},remove:function(t){confirm("确定要删除客户端？")&&this.removeClient(t.target.value)}}),computed:(0,s.mapGetters)(["clients","online"]),created:function(){this.loadClients()}}},134:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(41),i=a(o),s=n(50);e["default"]={name:"file",methods:(0,i["default"])({},(0,s.mapActions)(["loadFiles","showModal","removeFile"]),{upload:function(){this.showModal({show:!0,type:"upload",title:"上传文件",form:"file",data:{}})},remove:function(t){confirm("确定要删除文件？")&&this.removeFile(t.target.value)},download:function(t){window.open("/api/file/download?id="+t.target.value)}}),computed:(0,s.mapGetters)(["files"]),created:function(){this.loadFiles()}}},135:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={name:"menus"}},136:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(141),i=a(o),s=n(41),l=a(s),r=n(50),u=n(361),d=a(u),c=n(362),f=a(c);e["default"]={name:"modal",components:{client:d["default"],file:f["default"]},methods:(0,l["default"])({},(0,r.mapActions)(["closeModal","submitForm"]),{fileForm:function(){var t=new FormData,e=this.data,n=e.fileType,a=e.uploadFile;return t.append("fileType",n),t.append("uploadFile",a),t},commit:function(){var t="/api/"+this.form+"/"+this.type;switch(this.form){case"client":this.submitForm({url:t,modal:this.$refs.modal,headers:{"Content-Type":"application/json"},formData:(0,i["default"])(this.data),action:"loadClients"});break;case"file":this.submitForm({url:t,modal:this.$refs.modal,formData:this.fileForm(),action:"loadFiles"});break;default:return}}}),computed:(0,r.mapState)({show:function(t){return t.modal.show},type:function(t){return t.modal.type},title:function(t){return t.modal.title},form:function(t){return t.modal.form},data:function(t){return t.modal.data}}),watch:{show:function(t){t&&$(this.$refs.modal).modal("show")}},mounted:function(){var t=this;$(this.$refs.modal).on("hidden.bs.modal",function(){t.closeModal()})}}},137:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={name:"navbar"}},138:function(t,e,n){"use strict";function a(t){return t&&t.__esModule?t:{"default":t}}Object.defineProperty(e,"__esModule",{value:!0});var o=n(41),i=a(o),s=n(50);e["default"]={name:"clientForm",computed:(0,i["default"])({},(0,s.mapState)({type:function(t){return t.modal.type},data:function(t){return t.modal.data}}),{client:{get:function(){return this.data},set:function(t){this.$store.commit("updateFormData",t)}}})}},139:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]={name:"fileForm",data:function(){return{fileType:"dists",uploadFile:{}}},methods:{upload:function(t){this.uploadFile=t.target.files[0]},updateFormData:function(){this.$store.commit("updateFormData",this.$data)}},watch:{fileType:"updateFormData",uploadFile:"updateFormData"}}},351:function(t,e){},355:function(t,e,n){var a,o;n(351),a=n(132);var i=n(363);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},356:function(t,e,n){var a,o;a=n(133);var i=n(368);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},357:function(t,e,n){var a,o;a=n(134);var i=n(365);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},358:function(t,e,n){var a,o;a=n(135);var i=n(364);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},359:function(t,e,n){var a,o;a=n(136);var i=n(367);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},360:function(t,e,n){var a,o;a=n(137);var i=n(369);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},361:function(t,e,n){var a,o;a=n(138);var i=n(366);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},362:function(t,e,n){var a,o;a=n(139);var i=n(370);o=a=a||{},"object"!=typeof a["default"]&&"function"!=typeof a["default"]||(o=a=a["default"]),"function"==typeof o&&(o=o.options),o.render=i.render,o.staticRenderFns=i.staticRenderFns,t.exports=a},363:function(module,exports){module.exports={render:function(){with(this)return _h("div",{attrs:{id:"app"}},[_h("navbar")," ",_h("div",{staticClass:"container-fluid"},[_h("div",{staticClass:"row"},[_h("menus")," ",_h("div",{staticClass:"col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main"},[_h("router-view",[_m(0)])])])])," ",_h("modal")])},staticRenderFns:[function(){with(this)return _h("h1",{staticClass:"page-header"},["Welcome"])}]}},364:function(module,exports){module.exports={render:function(){with(this)return _h("div",{staticClass:"col-sm-3 col-md-2 sidebar"},[_h("ul",{staticClass:"nav nav-sidebar"},[_h("router-link",{attrs:{to:"/clients",tag:"li","active-class":"active"}},[_m(0)])," ",_h("router-link",{attrs:{to:"/files",tag:"li","active-class":"active"}},[_m(1)])])])},staticRenderFns:[function(){with(this)return _h("a",["客户端管理"])},function(){with(this)return _h("a",["文件管理"])}]}},365:function(module,exports){module.exports={render:function(){with(this)return _h("div",{attrs:{id:"files-table"}},[_h("p",[_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:upload}},["上传"])])," ",_h("table",{staticClass:"table table-striped table-bordered table-hover table-condensed"},[_m(0)," ",_h("tbody",[_l(files,function(t){return _h("tr",{key:t._id},[_h("td",[_s(t.name)])," ",_h("td",[_s(t.type)])," ",_h("td",[_s(t.createTime)])," ",_h("td",[_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},domProps:{value:t._id},on:{click:remove}},["删除"])," ",_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},domProps:{value:t._id},on:{click:download}},["下载"])])])})])])])},staticRenderFns:[function(){with(this)return _h("thead",[_h("tr",[_h("td",["文件名"])," ",_h("td",["文件类型"])," ",_h("td",["上传时间"])," ",_h("td",["操作"])])])}]}},366:function(module,exports){module.exports={render:function(){with(this)return _h("form",{staticClass:"form-horizontal",attrs:{style:"padding: 15px;"}},["edit"===type?_h("input",{directives:[{name:"model",rawName:"v-model",value:client.id,expression:"client.id"}],attrs:{type:"hidden"},domProps:{value:_s(client.id)},on:{input:function(t){t.target.composing||(client.id=t.target.value)}}}):_e()," ",_h("div",{staticClass:"form-group"},[_m(0)," ",_h("div",{staticClass:"col-sm-5"},[_h("input",{directives:[{name:"model",rawName:"v-model",value:client.key,expression:"client.key"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:_s(client.key)},on:{input:function(t){t.target.composing||(client.key=t.target.value)}}})])])," ",_h("div",{staticClass:"form-group"},[_m(1)," ",_h("div",{staticClass:"col-sm-5"},[_h("input",{directives:[{name:"model",rawName:"v-model",value:client.token,expression:"client.token"}],staticClass:"form-control",attrs:{type:"text"},domProps:{value:_s(client.token)},on:{input:function(t){t.target.composing||(client.token=t.target.value)}}})])])," ",_h("div",{staticClass:"form-group"},[_m(2)," ",_h("div",{staticClass:"col-sm-5"},[_h("textarea",{directives:[{name:"model",rawName:"v-model",value:client.description,expression:"client.description"}],staticClass:"form-control",domProps:{value:_s(client.description)},on:{input:function(t){t.target.composing||(client.description=t.target.value)}}})])])])},staticRenderFns:[function(){with(this)return _h("label",{staticClass:"col-sm-4 control-label"},["key"])},function(){with(this)return _h("label",{staticClass:"col-sm-4 control-label"},["token"])},function(){with(this)return _h("label",{staticClass:"col-sm-4 control-label"},["备注"])}]}},367:function(module,exports){module.exports={render:function(){with(this)return _h("div",{ref:"modal",staticClass:"modal fade",attrs:{tabindex:"-1",role:"dialog","aria-labelledby":"modal-title"}},[_h("div",{staticClass:"modal-dialog"},[_h("div",{staticClass:"modal-content"},[_h("div",{staticClass:"modal-header"},[_m(0)," ",_h("h4",{staticClass:"modal-title"},[_s(title)])])," ",_h("div",{staticClass:"modal-body"},[_h(form,{tag:"component"})])," ",_h("div",{staticClass:"modal-footer"},[_h("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:commit}},["确认"])," ",_m(1)])])])])},staticRenderFns:[function(){with(this)return _h("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[_h("span",{attrs:{"aria-hidden":"true"}},["×"])])},function(){with(this)return _h("button",{staticClass:"btn btn-default",attrs:{type:"button","data-dismiss":"modal"}},["取消"])}]}},368:function(module,exports){module.exports={render:function(){with(this)return _h("div",{attrs:{id:"clients-table"}},[_h("p",[_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:add}},["添加"])])," ",_h("p",["当前在线："+_s(online)])," ",_h("table",{staticClass:"table table-striped table-bordered table-hover table-condensed"},[_m(0)," ",_h("tbody",[_l(clients,function(t){return _h("tr",{key:t._id},[_h("td",[_s(t.key)])," ",_h("td",[_s(t.token)])," ",_h("td",[_s(t.description)])," ",_h("td",[_s(t.createTime)])," ",_h("td",[_s(t.status)])," ",_h("td",[_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},on:{click:function(e){edit(t)}}},["编辑"])," ",_h("button",{staticClass:"btn btn-default",attrs:{type:"button"},domProps:{value:t._id},on:{click:remove}},["删除"])])])})])])])},staticRenderFns:[function(){with(this)return _h("thead",[_h("tr",[_h("td",["key"])," ",_h("td",["token"])," ",_h("td",["备注"])," ",_h("td",["创建时间"])," ",_h("td",["状态"])," ",_h("td",["操作"])])])}]}},369:function(module,exports){module.exports={render:function(){with(this)return _m(0)},staticRenderFns:[function(){with(this)return _h("nav",{staticClass:"navbar navbar-inverse navbar-fixed-top"},[_h("div",{staticClass:"container-fluid"},[_h("div",{staticClass:"navbar-header"},[_h("button",{staticClass:"navbar-toggle collapsed",attrs:{type:"button","data-toggle":"collapse","data-target":"#navbar","aria-expanded":"false","aria-controls":"navbar"}},[_h("span",{staticClass:"sr-only"},["Toggle navigation"])," ",_h("span",{staticClass:"icon-bar"})," ",_h("span",{staticClass:"icon-bar"})," ",_h("span",{staticClass:"icon-bar"})])," ",_h("a",{staticClass:"navbar-brand",attrs:{href:"#"}},["后台管理系统"])])," ",_h("div",{staticClass:"navbar-collapse collapse",attrs:{id:"navbar"}},[_h("ul",{staticClass:"nav navbar-nav navbar-right"},[_h("li",[_h("a",{attrs:{href:"#"}},["修改密码"])])," ",_h("li",[_h("a",{attrs:{href:"/user/logout"}},["退出"])])])])])])}]}},370:function(module,exports){module.exports={render:function(){with(this)return _h("form",{staticClass:"form-horizontal",attrs:{style:"padding: 15px;"}},[_h("div",{staticClass:"form-group"},[_m(0)," ",_h("div",{staticClass:"col-sm-5"},[_h("select",{directives:[{name:"model",rawName:"v-model",value:fileType,expression:"fileType"}],on:{change:function(t){fileType=Array.prototype.filter.call(t.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value})[0]}}},[_m(1)," ",_m(2)," ",_m(3)," ",_m(4)])])])," ",_h("div",{staticClass:"form-group"},[_m(5)," ",_h("div",{staticClass:"col-sm-5"},[_h("input",{staticClass:"form-control",attrs:{type:"file"},on:{change:upload}})])])])},staticRenderFns:[function(){with(this)return _h("label",{staticClass:"col-sm-4 control-label"},["文件类型"])},function(){with(this)return _h("option",{attrs:{value:"dists"}},["更新包"])},function(){with(this)return _h("option",{attrs:{value:"imgs"}},["图片"])},function(){with(this)return _h("option",{attrs:{value:"logs"}},["日志"])},function(){with(this)return _h("option",{attrs:{value:"others"}},["其他"])},function(){with(this)return _h("label",{staticClass:"col-sm-4 control-label"},["文件"])}]}}});
//# sourceMappingURL=app.8f71bc94db0e24a41310.js.map